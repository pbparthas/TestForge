<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TestForge - Security Architecture</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg-primary: #0f0f0f;
      --bg-secondary: #1a1a1a;
      --bg-tertiary: #242424;
      --border: #333;
      --text-primary: #e0e0e0;
      --text-secondary: #888;
      --text-muted: #666;
      --accent-blue: #3b82f6;
      --accent-green: #22c55e;
      --accent-purple: #a855f7;
      --accent-orange: #f97316;
      --accent-pink: #ec4899;
      --accent-cyan: #06b6d4;
      --accent-yellow: #eab308;
      --accent-red: #ef4444;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
    }

    .top-nav {
      background: #0a0a0f;
      padding: 12px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border);
    }

    .top-nav-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: var(--text-primary);
    }

    .top-nav-brand-icon {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-green));
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 12px;
    }

    .top-nav-brand span {
      font-weight: 600;
      font-size: 14px;
    }

    .top-nav-links {
      display: flex;
      gap: 8px;
    }

    .top-nav-link {
      padding: 8px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 13px;
      transition: all 0.2s;
    }

    .top-nav-link:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .top-nav-link.active {
      background: var(--accent-red);
      border-color: var(--accent-red);
      color: white;
    }

    .header {
      background: linear-gradient(135deg, #1a0a0a 0%, #0f0f0f 50%, #0a1a1a 100%);
      padding: 48px 32px;
      text-align: center;
      border-bottom: 1px solid var(--border);
    }

    .header h1 {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 12px;
      background: linear-gradient(135deg, var(--accent-red), var(--accent-orange));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-subtitle {
      font-size: 16px;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto;
    }

    .main-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px;
    }

    .section {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 20px;
      color: var(--text-primary);
    }

    .section-icon {
      font-size: 24px;
    }

    .intro-note {
      background: rgba(239, 68, 68, 0.1);
      padding: 16px 20px;
      border-radius: 8px;
      border-left: 4px solid var(--accent-red);
      margin-bottom: 24px;
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .security-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
    }

    .security-layer-card {
      background: var(--bg-tertiary);
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .security-layer-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }

    .security-layer-header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .security-layer-num {
      width: 32px;
      height: 32px;
      background: rgba(255,255,255,0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      color: white;
    }

    .security-layer-name {
      font-weight: 600;
      font-size: 16px;
      color: white;
    }

    .security-layer-body {
      padding: 16px 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .security-detail {
      font-size: 13px;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      gap: 10px;
      line-height: 1.4;
    }

    .security-tech {
      background: var(--bg-secondary);
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      color: var(--accent-cyan);
      flex-shrink: 0;
      min-width: 90px;
      text-align: center;
    }

    .jailbreak-section {
      background: var(--bg-tertiary);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 12px;
      padding: 20px;
    }

    .jailbreak-header {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
      font-size: 16px;
      color: var(--accent-red);
      margin-bottom: 16px;
    }

    .jailbreak-icon {
      font-size: 20px;
    }

    .jailbreak-patterns {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .jailbreak-patterns code {
      background: rgba(239, 68, 68, 0.1);
      color: var(--accent-red);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-family: 'SF Mono', Monaco, monospace;
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .defense-note {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 24px;
      padding: 16px;
      background: rgba(34, 197, 94, 0.1);
      border-radius: 8px;
      border-left: 4px solid var(--accent-green);
    }

    .defense-note strong {
      color: var(--accent-green);
    }

    /* Additional Security Sections */
    .workflow-diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
      padding: 20px;
      background: var(--bg-tertiary);
      border-radius: 8px;
      margin-top: 16px;
    }

    .workflow-step {
      background: var(--bg-secondary);
      padding: 12px 20px;
      border-radius: 8px;
      border: 1px solid var(--border);
      font-size: 13px;
      font-weight: 500;
    }

    .workflow-arrow {
      color: var(--accent-cyan);
      font-size: 20px;
    }

    .tech-stack-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .tech-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: var(--bg-tertiary);
      border-radius: 8px;
      border: 1px solid var(--border);
    }

    .tech-icon {
      font-size: 20px;
    }

    .tech-name {
      font-size: 13px;
      font-weight: 500;
    }

    .tech-desc {
      font-size: 11px;
      color: var(--text-secondary);
    }

    /* Responsive Styles */
    @media (max-width: 768px) {
      .top-nav {
        padding: 12px 16px;
        flex-wrap: wrap;
        gap: 12px;
      }

      .top-nav-links {
        gap: 8px;
        flex-wrap: wrap;
      }

      .top-nav-link {
        font-size: 12px;
        padding: 6px 12px;
      }

      .header {
        padding: 32px 16px;
      }

      .header h1 {
        font-size: 28px;
      }

      .header-subtitle {
        font-size: 14px;
      }

      .main-content {
        padding: 16px;
      }

      .section {
        padding: 16px;
      }

      .section-title {
        font-size: 18px;
      }

      .security-grid {
        grid-template-columns: 1fr;
      }

      .security-layer-body {
        padding: 12px 16px;
      }

      .security-detail {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }

      .security-tech {
        min-width: auto;
      }

      .jailbreak-patterns code {
        font-size: 11px;
        padding: 4px 8px;
      }

      .workflow-diagram {
        flex-direction: column;
      }

      .workflow-arrow {
        transform: rotate(90deg);
      }
    }

    @media (max-width: 480px) {
      .top-nav-brand span {
        display: none;
      }

      .header h1 {
        font-size: 24px;
      }

      .security-layer-header {
        padding: 12px 16px;
      }

      .security-layer-name {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <nav class="top-nav">
    <a href="index.html" class="top-nav-brand">
      <div class="top-nav-brand-icon">TF</div>
      <span>TestForge</span>
    </a>
    <div class="top-nav-links">
      <a href="index.html" class="top-nav-link">Home</a>
      <a href="architecture.html" class="top-nav-link">Architecture</a>
      <a href="agents.html" class="top-nav-link">AI Agents</a>
      <a href="security.html" class="top-nav-link active">Security</a>
    </div>
  </nav>

  <header class="header">
    <h1>Security Architecture</h1>
    <p class="header-subtitle">Defense-in-depth security across 7 layers protecting authentication, data, APIs, AI systems, and providing full audit trails</p>
  </header>

  <main class="main-content">
    <!-- Overview -->
    <div class="section">
      <div class="section-title">
        <span class="section-icon">&#128274;</span>
        Security Overview
      </div>
      <div class="intro-note">
        TestForge implements defense-in-depth security with multiple layers of protection. Even if one layer is compromised, others continue to protect the system. All AI-generated code requires human review before production use.
      </div>

      <div class="security-grid">
        <!-- Authentication -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.4), rgba(16, 185, 129, 0.4));">
            <span class="security-layer-num">1</span>
            <span class="security-layer-name">Authentication</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">JWT Tokens</span> Access (15m) + Refresh (7d) tokens</div>
            <div class="security-detail"><span class="security-tech">bcrypt</span> Password hashing with 10 salt rounds</div>
            <div class="security-detail"><span class="security-tech">Active Check</span> Verify user account not disabled</div>
            <div class="security-detail"><span class="security-tech">Token Rotation</span> Refresh tokens stored in DB, rotated on use</div>
          </div>
        </div>

        <!-- Authorization -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(234, 179, 8, 0.4), rgba(249, 115, 22, 0.4));">
            <span class="security-layer-num">2</span>
            <span class="security-layer-name">Authorization (RBAC)</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">Roles</span> admin, manager, lead, qae + custom roles</div>
            <div class="security-detail"><span class="security-tech">Permissions</span> Fine-grained: resource:action (testcase:create)</div>
            <div class="security-detail"><span class="security-tech">Teams</span> Project-level team role assignments</div>
            <div class="security-detail"><span class="security-tech">System Roles</span> Protected from deletion/demotion</div>
          </div>
        </div>

        <!-- Data Protection -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(34, 197, 94, 0.4));">
            <span class="security-layer-num">3</span>
            <span class="security-layer-name">Data Protection</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">AES-256-CBC</span> Encrypt API tokens, credentials, secrets</div>
            <div class="security-detail"><span class="security-tech">Random IV</span> Unique initialization vector per operation</div>
            <div class="security-detail"><span class="security-tech">Env Keys</span> Encryption keys from environment only</div>
            <div class="security-detail"><span class="security-tech">No Plaintext</span> Passwords stored as hashes only</div>
          </div>
        </div>

        <!-- API Security -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(249, 115, 22, 0.4), rgba(234, 179, 8, 0.4));">
            <span class="security-layer-num">4</span>
            <span class="security-layer-name">API Security</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">Rate Limit</span> 100 requests per 15 minutes per IP</div>
            <div class="security-detail"><span class="security-tech">CORS</span> Whitelist frontend origins only</div>
            <div class="security-detail"><span class="security-tech">Body Limit</span> 10MB max JSON payload size</div>
            <div class="security-detail"><span class="security-tech">Zod</span> Schema validation on all inputs</div>
          </div>
        </div>

        <!-- AI Safety -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.4), rgba(236, 72, 153, 0.4));">
            <span class="security-layer-num">5</span>
            <span class="security-layer-name">AI Safety</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">Jailbreak</span> 8 regex patterns block prompt injection</div>
            <div class="security-detail"><span class="security-tech">Token Cap</span> 4096 max output tokens per request</div>
            <div class="security-detail"><span class="security-tech">No Execute</span> Generated code saved, never auto-run</div>
            <div class="security-detail"><span class="security-tech">JSON Only</span> Structured output schemas enforced</div>
          </div>
        </div>

        <!-- HITL -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.4), rgba(34, 197, 94, 0.4));">
            <span class="security-layer-num">6</span>
            <span class="security-layer-name">Human-in-the-Loop</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">Risk Score</span> AI artifacts assessed before approval</div>
            <div class="security-detail"><span class="security-tech">Workflow</span> Draft &rarr; Review &rarr; Approve/Reject</div>
            <div class="security-detail"><span class="security-tech">SLA</span> Review deadlines with escalation</div>
            <div class="security-detail"><span class="security-tech">Feedback</span> Rejection reasons improve AI</div>
          </div>
        </div>

        <!-- Audit -->
        <div class="security-layer-card">
          <div class="security-layer-header" style="background: linear-gradient(135deg, rgba(234, 179, 8, 0.4), rgba(249, 115, 22, 0.4));">
            <span class="security-layer-num">7</span>
            <span class="security-layer-name">Audit & Compliance</span>
          </div>
          <div class="security-layer-body">
            <div class="security-detail"><span class="security-tech">Full Logging</span> Category, severity, metadata captured</div>
            <div class="security-detail"><span class="security-tech">Attribution</span> User + IP address on every action</div>
            <div class="security-detail"><span class="security-tech">Change Track</span> Old/new values recorded</div>
            <div class="security-detail"><span class="security-tech">Security Events</span> Auth failures tracked separately</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Prompt Injection Defense -->
    <div class="section">
      <div class="section-title">
        <span class="section-icon">&#128737;</span>
        Prompt Injection Defense
      </div>
      <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 14px;">
        AI systems are vulnerable to prompt injection attacks where malicious inputs attempt to override system instructions. TestForge implements regex-based detection for common jailbreak patterns.
      </p>
      <div class="jailbreak-section">
        <div class="jailbreak-header">
          <span class="jailbreak-icon">&#128683;</span>
          Blocked Patterns (8 regex rules)
        </div>
        <div class="jailbreak-patterns">
          <code>"ignore previous instructions"</code>
          <code>"you are now DAN/jailbroken"</code>
          <code>"pretend you have no restrictions"</code>
          <code>"system: override"</code>
          <code>"forget your rules"</code>
          <code>"bypass your safety"</code>
          <code>"act as if you have no guidelines"</code>
          <code>"disable your ethics"</code>
        </div>
      </div>
      <div class="defense-note">
        <strong>Defense Action:</strong> Requests matching these patterns are immediately blocked, logged to the security audit trail, and the user is notified. Repeated attempts may trigger additional security measures.
      </div>
    </div>

    <!-- HITL Workflow -->
    <div class="section">
      <div class="section-title">
        <span class="section-icon">&#9989;</span>
        Human-in-the-Loop Approval Workflow
      </div>
      <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 14px;">
        All AI-generated artifacts (test cases, scripts, etc.) go through a mandatory review process before production use.
      </p>
      <div class="workflow-diagram">
        <div class="workflow-step">AI Generates Artifact</div>
        <span class="workflow-arrow">&rarr;</span>
        <div class="workflow-step">Risk Assessment</div>
        <span class="workflow-arrow">&rarr;</span>
        <div class="workflow-step">Submit for Review</div>
        <span class="workflow-arrow">&rarr;</span>
        <div class="workflow-step">Human Reviews</div>
        <span class="workflow-arrow">&rarr;</span>
        <div class="workflow-step" style="border-color: var(--accent-green);">Approve / Reject</div>
      </div>
      <div class="defense-note" style="margin-top: 20px;">
        <strong>Risk-Based Routing:</strong> Higher risk artifacts (e.g., scripts modifying production data) are automatically flagged for senior review. SLA tracking ensures timely reviews with escalation for overdue items.
      </div>
    </div>

    <!-- Security Stack -->
    <div class="section">
      <div class="section-title">
        <span class="section-icon">&#128736;</span>
        Security Technology Stack
      </div>
      <div class="tech-stack-grid">
        <div class="tech-item">
          <span class="tech-icon">&#128272;</span>
          <div>
            <div class="tech-name">JWT (jsonwebtoken)</div>
            <div class="tech-desc">Token-based authentication</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#128274;</span>
          <div>
            <div class="tech-name">bcryptjs</div>
            <div class="tech-desc">Password hashing</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#128273;</span>
          <div>
            <div class="tech-name">Node crypto (AES-256)</div>
            <div class="tech-desc">Data encryption</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#128275;</span>
          <div>
            <div class="tech-name">express-rate-limit</div>
            <div class="tech-desc">API rate limiting</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#127760;</span>
          <div>
            <div class="tech-name">CORS middleware</div>
            <div class="tech-desc">Cross-origin protection</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#9989;</span>
          <div>
            <div class="tech-name">Zod</div>
            <div class="tech-desc">Schema validation</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#128203;</span>
          <div>
            <div class="tech-name">Prisma</div>
            <div class="tech-desc">SQL injection prevention</div>
          </div>
        </div>
        <div class="tech-item">
          <span class="tech-icon">&#128220;</span>
          <div>
            <div class="tech-name">Pino logger</div>
            <div class="tech-desc">Structured audit logging</div>
          </div>
        </div>
      </div>
    </div>
  </main>
</body>
</html>
